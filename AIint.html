<!DOCTYPE html><html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech to Text & Text to Speech</title>
</head>
<body onload="">
    <h1>Speech to Text & Text to Speech</h1><button onclick="startListening()">Speak</button>
<p id="output"></p>
<input type="text" x-webkit-speech>
<textarea id="text" placeholder="Enter text to speak"></textarea>
<button onclick="speakText(document.getElementById('text').value)">Speak</button>
<button onclick=" intpyesno()">Interprite</button>
<div id="ai"></div>
<div id="result"></div>
<script>
    // Speech to Text
let word = [];
let now = new Date();
function stringToArray(str) {
    return str.split(' '); // Splits the string by spaces into an array
}
    function startListening() {
        const recognition = new window.webkitSpeechRecognition();
        recognition.lang = 'gu-IN';
        recognition.start();

        recognition.onresult = (event) => {
            //document.getElementById('output').innerText = event.results[0][0].transcript;
	//word = stringToArray(event.results[0][0].transcript);
	document.getElementById('output').innerText="";
	//for(let i=0; i< word.length ; i++)
	//{
	//	document.getElementById('output').innerText = document.getElementById('output').innerText+" "+word[i];
	//}
        };
	
        recognition.onerror = (event) => {
            alert('Error: ' + event.error);
        };
    }
    
    // Text to Speech
    function speakText() {
  const text = "કેમ છો?";
  const speech = new SpeechSynthesisUtterance(text);

  function loadVoices() {
    const voices = window.speechSynthesis.getVoices();

    // Debug: see available voices
    console.log(voices.map(v => v.lang + " - " + v.name));

    // Try Gujarati voice
    const guVoice = voices.find(v => v.lang === "gu-IN");

    if (guVoice) {
      speech.voice = guVoice;
      speech.lang = "gu-IN";
    } else {
      alert("Gujarati voice not available on this device");
    }

    window.speechSynthesis.speak(speech);
  }

  if (speechSynthesis.getVoices().length === 0) {
    speechSynthesis.addEventListener("voiceschanged", loadVoices);
  } else {
    loadVoices();
  }
}
let source = "";
let dst = "";
let date = 0;
let month = 0;
let year = 0;
let hour ="";
let status = "return";
let reading = 0;
let yesorno = 0;
let yes = 0;
let no = 0;
function start()
{
	speakText("ગુગ્જી માં તમારુ હાર્દિક સ્વાગત છે, તમારા ટ્ર્ક માટે માલ ગોતવા હું તમારી શું મદદ કરી શકુ ?");
}
function intpyesno()
{
	//alert(yesorno);
	if(yesorno == 0)
	{
		intp();
	}
	else
	{
		yesno();
	}
}
function yesno()
{
	word = stringToArray(document.getElementById('text').value);
	for(let i=0; i< word.length; i++)
	{
		if(word[i] == "હા")
		{
			yes = 1;
			break;
		}
		if(word[i] == "ના")
		{
			no = 1;
			break;
		}
	}
	if(no == 1)
	{
		document.getElementById('text').value = "ના";
		intp();
		yesorno = 0;
		yes = 0;
		no = 0;
	}
	else if(yes == 1)
	{
		document.getElementById('ai').innerHTML = "તમને સ્થડ અને રસ્તો નકશાં માં બતાવવા માં આવ્યો છે સાચો હોય તો ખરા ની નીશાની દબાવો, ખોટો હોય તો ઉપર નાં ખાના માં તમારુ સ્થડ શોધી ખરા ની નીશાની દબાવો";
		yesorno = 0;
		yes = 0;
		no = 0;
		speakText(document.getElementById('ai').innerText);
	}
	else
	{
		speakText(document.getElementById('ai').innerText);
	}
}
function intp()
{
let minute="00";
let ltime="";
let dest = [];
let ignore = ["છે", "છું", "હું","મારે", "મને", "અમારું", "તમે", "તમારે", "તમને",
 "તમારું", "ના", "રોજ", "રોજે", "ફેરો", "ફેરા" , "નાખવા", "નાખવાનો", "જાઉં",
 "જઉં", "જવા", "જવું", "જવાનું", "જાવ", "જાવા", "જાવું", "જાવુ", "જાવાનું",
 "કરવા", "કરવું", "કરવાનું", "કરવાનો", "સેટ", "કરો", "પહોચવાનું", "નીડવાનું", 
"સવાર", "સવારે", "સવારના", "બપોર", "બપોરે", "બપોરના", "સાંજ", "સાંજે", "સાંજના",
"રાત્રે", "રાતે", "રાતના", "સાડા","શાળા", "સાળા","હડા", "સવા", "પોણા", "વાગ્યે", "વાગે",
 "કલાક", "કલાકે", "તારીખ", "તારીખે", "આજે", "આજ", "કાલ", "કાલે", "પરમ",
 "દીવસે", "દીવસ", "દિવસ", "દિવસે", "દીવશ", "દીવશે", "દિવશ", "દિવશે", "હમણાં", "હમણાંનું",
"જય", "રહ્યા", "છો", "તે", "બોલો", "હા",
 "અત્યાર", "અત્યારે", "હવે", "હવેનો", "હવેનું", "લાઇવ", "લાઈવ", "માં", "મા", "નો", "વાગા",
 "રિટર્ન", "રીટન", "રિટન", "સંભળાવો",
"સંભડાવો", 
 "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "જાન્યુઆરી", "ફેબ્રુઆરી", "માર્ચ", "એપ્રિલ", "મે", "જૂન", "જુલાઈ", "ઓગસ્ટ", "સપ્ટેમ્બર", "ઓક્ટોબર", "નવેમ્બર", "ડિસેમ્બર"];  
let Num = [];
let datestmp;
let timestmp = -1;
let j=0;
let pona;
let bopar = 0;
let dp =0;
let tp=0;
let param =0;
word = stringToArray(document.getElementById('text').value);
let pointer = 0;
for(let i=0; i< word.length; i++)
{
if(word[i] == "સંભડાવો")
{
	source = "";
	dest = [];
	dst = "";
	date = 0;
	month = 0;
	year = 0;
	hour ="";
	minute="00";
	ltime="";
	reading = 1;
	break;
}
if(word[i] == "રદ")
{
source = "";
dest = [];
dst = "";
date = 0;
month = 0;
year = 0;
hour ="";
minute="00";
ltime="";
break;
}
if( status == "return" || status == "radar")
{
if (word[i] == "હમણાં" || word[i] == "હમણાંનું" || word[i] == "હમણાંનો" || word[i] == "હવે" || word[i] == "હવેનો" || word[i] == "હવેનું" || word[i] == "અત્યાર" || word[i] == "અત્યારે" || word[i] == "લાઇવ" || word[i] == "લાઈવ")
{
	status = "live";
}
}
if( status == "live" || status == "radar")			
{
if (word[i] == "રિટર્ન" || word[i] == "રીટન")
{
	status = "return";
}
}
if(word[i] == "રડાર")
{
	status="radar";
}
if(!isNaN(word[i]) && isFinite(word[i]))
{
let n =  Number(word[i]);
if(n >=1 && n <=31)
{
	word[i] =  Number(word[i]);
	Num[j] = i;
	j = j+1;
}
}
if(word[i]=="એક")
{
	word[i] = 1;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="બે")
{
	word[i] = 2;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="ત્રણ")
{
	word[i] = 3;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="ચાર")
{
	word[i] = 4;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="પાંચ")
{
	word[i] = 5;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="છ")
{
	word[i] = 6;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="સાત")
{
	word[i] = 7;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="આઠ")
{
	word[i] = 8;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="નવ")
{
	word[i] = 9;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="દસ")
{
	word[i] = 10;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="અગ્યાર")
{
	word[i] = 11;
	Num[j] = i;
	j = j+1;
}
else if(word[i]=="બાર")
{
	word[i] = 12;
	Num[j] = i;
	j = j+1;
}
else
{

}
if(word[i] == "જાન્યુઆરી")
{
	month = 1;
}
else if(word[i] == "ફેબ્રુઆરી")
{
	month = 2;
}
else if(word[i] == "માર્ચ")
{
	month = 3;
}
else if(word[i] == "એપ્રિલ")
{
	month = 4;
}
else if(word[i] == "મે")
{
	month = 5;
}
else if(word[i] == "જૂન")
{
	month = 6;
}
else if(word[i] == "જુલાઈ")
{
	month = 7;
}
else if(word[i] == "ઓગસ્ટ")
{
	month = 8;
}
else if(word[i] == "સપ્ટેમ્બર")
{
	month = 9;
}
else if(word[i] == "ઓક્ટોબર")
{
	month = 10;
}
else if(word[i] == "નવેમ્બર")
{
	month = 11;
}
else if(word[i] == "ડિસેમ્બર")
{
	month = 12;
}
else
{
}
if(word[i] == "તારીખ" || word[i] == "તારીખે")
{
	datestmp = i;
}
if(word[i] == "પરમ")
{
	param = 1;
}
if(word[i] == "આજે" || word[i] == "આજ")
{
	date = now.getDate();
	month = now.getMonth()+1;
	year = now.getFullYear();
}
else if(word[i] == "કાલ" || word[i] == "કાલે")    
{
	date = now.getDate()+1;
	month = now.getMonth()+1;
	year = now.getFullYear();
}
else if(word[i] == "દીવસે" || word[i] == "દીવસ" || word[i] == "દિવસ" || word[i] == "દિવસે" || word[i] == "દીવશ" || word[i] == "દીવશે" || word[i] == "દિવશ" || word[i] == "દિવશે")
{
	if(param == 1)
	{
		date = now.getDate()+2;
		month = now.getMonth()+1;
		year = now.getFullYear();
	}
}
else
{
}
if(word[i] == "વાગ્યે" || word[i] =="વાગે" || word[i] == "કલાક" || word[i] =="કલાકે" || word[i] =="વાગા")
{
	hour = "";
	tp=1;
	let a = word[i-1].toString();
	if(a.includes(":"))
	{
		//dest[dp-1] = "";
		hour = word[i-1];
	}
	else
	{
		timestmp = i-1;
	}
}
if(word[i] == "સાડા" || word[i] =="શાળા" || word[i] == "સાળા" || word[i] =="હડા")
{
	minute = "30";
}
else if(word[i] == "સવા")
{
	minute = "15";
}
else if(word[i] == "પોણા")
{
	minute = "45";
	pona = 1;
}
else
{
}
if(word[i] == "સવાર" || word[i] == "સવારે" || word[i] == "સવારના")
{
	ltime = "AM";
}
else if(word[i] == "સાંજ" || word[i] == "સાંજે" || word[i] == "સાંજના" || word[i] == "રાત્રે" || word[i] == "રાતે" || word[i] == "રાતના")
{
	ltime = "PM";
}
else if(word[i] == "બપોર" || word[i] == "બપોરે" || word[i] == "બપોરના")
{
	bopar = 1;
}
else
{
}
if(((!ignore.includes(word[i].toString())) && (!/^\d+$/.test(word[i]))))
{
	let a = word[i].toString();
	if(!a.includes(":"))
	{
		source = "";
		dst = "";
		dest[dp] = word[i];
		dp= dp + 1;
	}
}
}
if(tp == 1)
{
if(timestmp!= -1)
{
	hour = word[timestmp];
	j=j-1;
	let a = 0;
	for(let k=0; k < j; k++)
	{
		if(Num[k]!=timestmp)
		{
			Num[a]=Num[k];
			a=a+1;
		}
	}
	if(pona == 1)
	{
		hour = hour-pona;
	}
	if(bopar == 1)
	{
		if(hour >= 10 && hour < 12)
		{
			ltime = "AM";
		}
		else if (hour >= 1 && hour <= 4 || hour == 12)
		{
			ltime = "PM";
		}
	}
}
else
{
	if(hour!="")
	{
		let a = hour.split(":");
		if(!isNaN(a[0]) && isFinite(a[0]))
		{
			let h = Number(a[0]);
			if(bopar == 1)
			{
				
			}
			if(pona == 1)
			{
				h=h-1;
				hour = h;
			}
			if(bopar == 1)
			{
				if(h >= 10 && h < 12)
				{
					ltime = "AM";
				}
				else if (h >= 1 && h <= 4 || h == 12)
				{
					ltime = "PM";
				}
			}
		}
	}
}
}
if(j ==1)
{
	date = 0;
}
if(j ==2)
{
	date = 0;
	month = 0;
}
if(j ==3)
{
	date = 0;
	month = 0;
	year = 0;
}
for(let k=0; k < j; k++)
{
		let a = Num[k];
		if(k==0)
		{
			if(date == 0 && word[a] >= 1 && word[a]<=31)
			{
				date = word[a];
			}
		}
		else if(k==1)
		{
			if(month == 0 && word[a] >= 1 && word[a]<=12)
			{
				month = word[a];
			}
		}
		else if(k==2)
		{
			if(month == 0 && word[a] >= 25 && word[a]<=26)
			{
				year = word[a];
			}
		}
		else{}
}
let sdp=0;
if(dst =="")
{
for(let i=0; i < dest.length; i++)
{
	if(dest[i]!= "થી")
	{
		dst = dst +" "+ dest[i];
	}
	else
	{
		source = dst;
		dst = "";
		sdp=1;
	}
}
}
	document.getElementById('result').innerHTML = "<table><tr><td>status:<td>"+status+
	"<tr><td>reading :<td>"+reading+
	"<tr><td>source :<td>"+source+
	"<tr><td>destination :<td>"+dst+
	"<tr><td>date :<td>"+date+
	"<tr><td>month :<td>"+month+
	"<tr><td>year :<td>"+year+
	"<tr><td>hour :<td>"+hour+
	"<tr><td>minute :<td>"+minute+
	"<tr><td>ltime :<td>"+ltime+
	"</table>";
	if(reading == 0)
	{
	if(status == "live")
	{
		document.getElementById('ai').innerHTML = "તમે અત્યારે";
		if(source == "")
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+ " તમારા લોકેશન થી";
		}
		else
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+source+" થી"; 
		}
		if(dst == "")
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" ક્યાં જય રહ્યા છો તે બોલો ?";
		}
		else
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" "+dst+" જય રહ્યા છો ?,";
			if(no == 1)
			{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" આમાં ફેરફાર કરવા માટે બોલો અથવા રદ કરો બોલો ?";
			}
			else
			{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" શું આ તમારે લાઇવ માં સેટ કરવુ છે, હા કે ના બોલો ?";
			}
			yesorno = 1;
		}
	}
	if(status == "return")
	{
		document.getElementById('ai').innerHTML = "તમે";
		if(source == "")
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+ " ક્યાં થી ";
		}
		else
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+source+" થી"; 
		}
		if(dst == "")
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" ક્યાં,";
		}
		else
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" "+dst+",";
		}
		if(date == 0)
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" કઇ ";
		}
		else
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" "+date;
			if(month == 0)
			{
				document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" "+(now.getMonth()+1);
			}
			else
			{
				document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" "+month;
			}
			if(year == 0)
			{
				document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" "+now.getFullYear();
			}
			else
			{
				document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" "+year;
			}
		}
		document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" તારીખે";
		if(hour == "")
		{
			
		}
		else
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" "+hour;
			if(minute == "00")
			{
				document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" વાગે";
			}
			else
			{
				document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+"  વાગે "+minute+" મીનીટે";
			}
		}
		if(source == "" || dst == "" || date == 0)
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" જય રહ્યા છો તે બોલો";
		}
		else
		{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" જય રહ્યા છો";
			if(no == 1)
			{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" આમાં ફેરફાર કરવા માટે બોલો અથવા રદ કરો બોલો ?";
			}
			else
			{
			document.getElementById('ai').innerHTML = document.getElementById('ai').innerText+" શું આ તમારે રિટર્ન માં સેટ કરવુ છે, હા કે ના બોલો ?";
			}
			yesorno = 1;
		}
	}
	}
	if(reading == 1)
	{
		if(status == "live")
		{
			document.getElementById('ai').innerHTML = "હવે હું લાઇવ સંભડાવુ છું";
		}
		if(status == "return")
		{
			document.getElementById('ai').innerHTML = "હવે હું રિટર્ન સંભડાવુ છું";
		}
		if(status == "radar")
		{
			document.getElementById('ai').innerHTML = "હવે હું રડાર સંભડાવુ છું";
		}
	}
	speakText(document.getElementById('ai').innerText);
}
</script>
</body>
</html>